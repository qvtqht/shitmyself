<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>OpenPGPJS Tests</title>

</head>
<body>

<script src="dist/openpgp.js"></script>
<script type="text/javascript"><!--

function get_key() {
    if (typeof(Storage) !== "undefined") {
        var privateKey = localStorage.getItem('privatekey');

        if (privateKey === null || privateKey.length === 0) {
            var privkey;
            var pubkey;

            var openpgp = window.openpgp;
            openpgp.initWorker({path:'dist/openpgp.worker.js'});

            var options = {
                userIds: [{ name:'Jon Smith' }],
                numBist: 4096,
                passphrase: 'hello test'
            };

            openpgp.generateKey(options).then(
                function(key) {
                    window.localStorage.setItem("privatekey", key.privateKeyArmored);
                    window.localStorage.setItem("publickey", key.publicKeyArmored);
                }
            );

        } else {
            document.write("private key already exists! yay!");
            document.write('<pre style="coor:blue;">');
            document.write(window.localStorage.getItem("privatekey"));
        }
    } else {
        document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Storage...";
    }
}


		// -->


</script>

<a onclick="window.localStorage.removeItem('privatekey'); window.localStorage.removeItem('publickey');">remove stored keys</a><br>

<a onclick="get_key();">generate new key</a>

</body>
</html>
